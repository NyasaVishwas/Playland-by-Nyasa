<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Love Run</title>
  <style>
    body {
      margin: 0;
      font-family: 'Comic Sans MS', cursive;
      background: linear-gradient(to bottom right, #ffe0e0, #ff0000);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    #game-container {
      background: #fff0f5;
      width: 800px;
      height: 450px;
      border-radius: 16px;
      box-shadow: 0 0 20px #f99393;
      overflow: hidden;
      position: relative;
    }



    canvas {
      display: block;
      background: transparent;
    }

    #score {
      position: absolute;
      top: 20px;
      left: 20px;
      background: white;
      padding: 8px 16px;
      border-radius: 12px;
      font-weight: bold;
      font-size: 18px;
      color: rgb(234, 33, 33);
      box-shadow: 0 0 10px #ff9f9f;
    }

    .end-screen, .start-screen {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgb(255, 210, 210);
      padding: 30px;
      border-radius: 16px;
      text-align: center;
      z-index: 100;
      box-shadow: 0 0 20px #ff5a5a;
    }

    .end-screen h2,
    .start-screen h2 {
      color: #d10000;
      font-size: 28px;
    }

    .end-screen p,
    .start-screen p {
      font-size: 18px;
      margin-bottom: 16px;
    }

    .end-screen button,
    .start-screen button {
      background: rgb(243, 61, 61);
      border: none;
      color: white;
      font-size: 16px;
      padding: 10px 20px;
      border-radius: 8px;
      margin: 6px;
      cursor: pointer;
    }

    .start-screen ul {
      text-align: left;
      font-size: 16px;
      margin-bottom: 16px;
    }

        .ground-line {
      position: absolute;
      left: 0;
      bottom: 60px; /* Adjust based on your character's Y */
      width: 100%;
      height: 20px;
      background: linear-gradient(to top, #90ee90, #b0ffb0);
      border-top: 2px dashed #ffffff80;
      z-index: 1;
    }

    .ground-base {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 60px; /* This should match ground-line's bottom offset */
      background: linear-gradient(to top, #8B4513, #a0522d); /* earthy brown gradient */
      z-index: 0;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }



  </style>
</head>
<body>
  <audio id="bgMusic" src="music.mp3" loop autoplay></audio>
  
  <div id="game-container">
    <canvas id="gameCanvas" width="800" height="450"></canvas>
    <div id="score">Score: 0</div>

    <!-- Start Screen with Rules -->
    <div id="start-screen" class="start-screen">
      <h2>Game Rules</h2>
      <ul>
        <li>Use <b>Spacebar</b> to jump</li>
        <li>Avoid the obstacles (they're negativity)</li>
        <li>Hearts collect kro to gain score</li>
        <li>Collect stars, wo negativity se protect krta h (Aura++)</li>
        <li>Reach 5000 points to meet me! ‚ù§Ô∏è</li>
        <li><b>Hint: </b>Double press Spacebar for higher jump</li>
      </ul>
      <button onclick="startGame()">Start Game</button>
    </div>

    <!-- Game Over Screen -->
    <div id="end-screen" class="end-screen" style="display:none;">
      <h2>üíî Areeee!</h2>
      <p>Tm negativity k pass kyu chale gye? <br>Mere pass aaoooo naaaa! <br><b>Final Score: <span id="finalScore">0</span></b></p>
      <button onclick="startGame()">Firse khelo</button>
      <button onclick="window.location.href='bubbles.html'">Back to Bubbles</button>
    </div>

    <!-- Game Win Screen -->
    <div id="win-screen" class="end-screen" style="display:none;">
      <h2>Hurrayyyy!</h2>
      <p>We finally met! <br>(Ab bs real me v jldi se mil le)<br><b>Final Score: <span id="finalScoreWin">0</span></b></p>

      <button onclick="startGame()">Play Again</button>
      <button onclick="window.location.href='bubbles.html'">Back to Bubbles</button><br>
      <button onclick="revealSecret()" style="background: #ff6b81; border: none; color: white; padding: 10px 20px; border-radius: 8px; margin-top: 10px; cursor: pointer;">Tmhara inaam üòÇ</button>

      <p id="secret-message" style="display:none; margin-top: 20px; font-size: 18px; color: #b30059; animation: fadeIn 1s ease; white-space: pre-wrap;">
        üíå Babe, idk how to explain but I really really love you.
        I really do.
        And I miss you so much, so veryyyyy much.
        I know, I should not feel sad, but mujhe
        boht bura lgta h ki tmhara birthday hmesha
        summer vacation me hi kyu aata hai?
        Mera v to mann krta h n tmhare sath rehne ka.
        Koi naa, next year to most probably college 
        me hi rehna h, yaayyyyyy.
        Ab kon bachayega tmhe mujhse??? (devil laugh)
        Ek aur baat bolna tha, sorry.....
        Iss baar sbkuch itna achanak se hua ki mai koi
        gift v nhi prepare krke de paayi tmhe (sad face)
        Isliye ye chhota sa fun website sirf tmhare liye üíñ
        Once again, Happy Birthday My Love ‚ù§Ô∏è
      </p>
    </div>


    <div class="ground-line"></div>
    <div class="ground-base"></div>

  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    const boyImg = new Image();
    const girlImg = new Image();
    boyImg.src = "./boy_logo.png";  
    girlImg.src = "./girl_logo.png";
    boyImg.alt = "boy";
    girlImg.alt = "girl";


    const heartEmoji = "‚ô•Ô∏è";
    const obstacleColors = ["#000000"];

    let player, obstacles, hearts, score, gameOver, gameWon, girl, speed;
    let playerReachedCenter = false;
    let stars = [];
    let invincible = false;
    let invincibleTimer = 0;
    const starEmoji = "‚≠ê";



    function startGame() {
      document.getElementById("start-screen").style.display = "none";
      player = { x: 50, y: 310, width: 40, height: 60, vy: 0, jumping: false, jumpCount: 0};
      obstacles = [];
      hearts = [];
      girl = null;
      score = 0;
      speed = 3;
      gameOver = false;
      gameWon = false;
      playerReachedCenter = false;

      document.getElementById("score").innerText = "Score: 0";
      document.getElementById("end-screen").style.display = "none";
      document.getElementById("win-screen").style.display = "none";

      generateObstacle();
      generateHeart();
      generateStar();
      requestAnimationFrame(gameLoop);
    }

    function generateObstacle() {
      if (score >= 5000 || gameOver || gameWon) return;

      const gap = 150 + Math.random() * 100;
      const lastX = obstacles.length > 0 ? obstacles[obstacles.length - 1].x : 0;

      if (obstacles.length === 0 || lastX < canvas.width - gap) {
        const color = obstacleColors[Math.floor(Math.random() * obstacleColors.length)];
        obstacles.push({
          x: canvas.width + Math.random() * 100,
          y: 340,
          width: 30 + Math.random() * 20, // smaller width
          height: 40,
          speed: speed,
          color: color
        });
      }

      setTimeout(generateObstacle, 1000 + Math.random() * 5000);
    }

      function generateHeart() {
        if (gameOver || gameWon) return;

        // Always spawn one heart
        hearts.push({
          x: canvas.width + Math.random() * 300,
          y: 270 + Math.random() * 60,
          width: 24,
          height: 24,
          speed: speed
        });

        if (Math.random() < 0.3) {
          hearts.push({
            x: canvas.width + 100 + Math.random() * 200,
            y: 270 + Math.random() * 60,
            width: 24,
            height: 24,
            speed: speed
          });
        }

        setTimeout(generateHeart, 800 + Math.random() * 1000); // Faster spawn
      }

      function generateStar() {
        if (gameOver || gameWon) return;

        if (Math.random() < 0.3) { // 20% chance to spawn
          stars.push({
            x: canvas.width + Math.random() * 300,
            y: 270 + Math.random() * 60,
            width: 24,
            height: 24,
            speed: speed
          });
        }

        setTimeout(generateStar, 7000 + Math.random() * 5000); // appears occasionally
      }



    function gameLoop() {
      if (gameOver || gameWon) return;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      player.vy += 1.5;
      player.y += player.vy;

      if (player.y > 310) {
        player.y = 310;
        player.vy = 0;
        player.jumpCount = 0;
      }

      if (player.jumping && !playerReachedCenter && player.x < canvas.width / 2 - player.width / 2) {
        player.x += 1; // Boost forward when jumping before center
      }

      if (invincible) {
        ctx.save();
        ctx.shadowColor = "#ff4d4d";
        ctx.shadowBlur = 20;
        ctx.drawImage(boyImg, player.x, player.y, player.width, player.height);
        ctx.restore();
      } else {
        ctx.drawImage(boyImg, player.x, player.y, player.width, player.height);
      }

      obstacles = obstacles.filter(ob => ob.x + ob.width > 0);
      for (const ob of obstacles) {
        ob.x -= ob.speed;
        ctx.fillStyle = ob.color;
        ctx.fillRect(ob.x, ob.y, ob.width, ob.height);

      if (!invincible && isColliding(player, ob)) {
          gameOver = true;
          document.getElementById("end-screen").style.display = "block";
          document.getElementById("finalScore").innerText = score;
          return;
        }
      }

      hearts = hearts.filter(h => h.x + h.width > 0);
      for (let i = 0; i < hearts.length; i++) {
        const h = hearts[i];
        h.x -= h.speed;
        ctx.font = "24px serif";
        ctx.fillText(heartEmoji, h.x, h.y);

        if (isColliding(player, h)) {
          score += 50;
          hearts.splice(i, 1);
          i--;
          if (score >= 5000 && !girl) {
            girl = { x: canvas.width + 100, y: 320, width: 30, height: 60 };
          }
        }
      }

      // Draw stars
      stars = stars.filter(st => st.x + st.width > 0);
      for (let i = 0; i < stars.length; i++) {
        const st = stars[i];
        st.x -= st.speed;
        ctx.font = "24px serif";
        ctx.fillText(starEmoji, st.x, st.y);

        if (isColliding(player, st)) {
          invincible = true;
          invincibleTimer = Date.now();
          stars.splice(i, 1);
          i--;
        }
      }

      // Check invincibility timer
      if (invincible && Date.now() - invincibleTimer > 5000) {
        invincible = false;
      }


      if (score > 0 && score % 500 === 0) speed += 0.02;

      document.getElementById("score").innerText = "Score: " + score;

      if (!playerReachedCenter) {
        if (player.x < canvas.width / 2 - player.width / 2) {
          player.x += 2; // move toward center
        } else {
          playerReachedCenter = true;
        }
      }


      if (girl) {
        girl.x -= speed;
        ctx.drawImage(girlImg, girl.x, girl.y, girl.width, girl.height);

        // Once girl appears, boy starts moving towards her
        if (player.x < girl.x - player.width) {
          player.x += 2; // move boy to girl slowly
        } else {
          gameWon = true;
          document.getElementById("win-screen").style.display = "block";
          document.getElementById("finalScoreWin").innerText = score;
        }
      }


      requestAnimationFrame(gameLoop);
    }

    function revealSecret() {
      const message = document.getElementById('secret-message');
      message.style.display = 'block';
    }

    document.getElementById("bgMusic").volume = 0.2;


    function isColliding(a, b) {
      return (
        a.x < b.x + b.width &&
        a.x + a.width > b.x &&
        a.y < b.y + b.height &&
        a.y + a.height > b.y
      );
    }

    document.addEventListener("keydown", (e) => {
      if ((e.code === "Space" || e.key === " ")) {
        if (player.jumpCount < 2) {
          player.vy = -20 + (player.jumpCount * -4); // 1st jump strong, 2nd jump soft
          player.jumpCount++;
        }
      }
    });


    // Wait for player to start
    window.onload = () => {
      document.getElementById("start-screen").style.display = "block";
    };
  </script>
      <footer style="
        position: fixed;
        bottom: 10px;
        width: 100%;
        text-align: center;
        font-size: 1.2rem;
        color: #ffffff;
        opacity: 0.7;
    ">
        Developed with ‚ù§Ô∏è by Nyasa
    </footer>

</body>
</html>
