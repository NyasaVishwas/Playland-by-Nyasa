<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Space Shooter</title>
  <style>
    /* Fullscreen and responsive canvas */
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: linear-gradient(to bottom, #000020, #000000);
      overflow: hidden;
      font-family: 'Arial', sans-serif;
      color: white;
      position: relative;
    }
    #gameCanvas {
      display: block;
      background: transparent;
      /* Make canvas fill the window while keeping aspect ratio */
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      margin: auto;
      max-width: 100vw;
      max-height: 100vh;
    }

    /* Scoreboard styling */
    #scoreboard {
      position: fixed;
      top: 10px;
      left: 10px;
      background: rgba(0, 0, 0, 0.7);
      padding: 10px 15px;
      border-radius: 10px;
      font-size: 1.2em;
      font-weight: bold;
      z-index: 10;
      user-select: none;
    }

    /* Popup message on the right side */
    #note-box {
      position: fixed;
      top: 20%;
      right: 20px;
      background: rgba(255, 192, 203, 0.95);
      color: #000;
      padding: 15px 20px;
      border-radius: 10px;
      font-size: 1.2em;
      max-width: 220px;
      box-shadow: 0 0 15px pink;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s ease;
      z-index: 10;
    }
    #note-box.show {
      opacity: 1;
      pointer-events: auto;
    }

#win-screen {
  position: fixed;
  top: 7%;
  left: 40%;
  width: 100vw;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 999;
  animation: fadeIn 1.5s ease-in-out;
  padding:20px;
}

.win-box {
  background: rgba(255, 240, 255, 0.96);
  color: #222;
  padding: 20px 25px;
  border-radius: 20px;
  box-shadow: 0 0 25px #ff8fd0;
  text-align: center;
  width: 90%;
  max-width: 340px;
  animation: popIn 1s ease;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}



.win-box h1 {
  font-size: 1.6em;
  margin-bottom: 10px;
  color: #ff3c96;
  animation: glowText 1.2s infinite alternate;
  line-height: 1.3;
}


.win-box img {
  width: 150px;
  border-radius: 12px;
  box-shadow: 0 0 15px #ffb6c1;
  margin: 15px 0;
}

.win-box button {
  margin-top: 10px;
  padding: 10px 20px;
  background: #ff69b4;
  border: none;
  color: white;
  border-radius: 8px;
  font-size: 1em;
  cursor: pointer;
  transition: background 0.3s ease;
}

.win-box button:hover {
  background: #ff92c2;
}


/* ✨ Animations */
@keyframes popIn {
  from {
    transform: scale(0.6);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes glowText {
  from {
    text-shadow: 0 0 10px #ff9bd2;
  }
  to {
    text-shadow: 0 0 20px #ff3c96;
  }
}



    /* Start, Rules and Game Over screens centered on top of game */
    #start-screen, #rules-screen, #game-over {
      position: fixed;
      top: 40%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      background: rgba(0,0,0,0.7);
      padding: 25px 30px;
      border-radius: 15px;
      z-index: 20;
      color: white;
      max-width: 350px;
    }

    #rules-screen {
      background: rgba(255,192,203,0.95);
      color: #000;
    }

    button {
      padding: 10px 20px;
      font-size: 1em;
      background: #ff69b4;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 15px;
      transition: background 0.3s ease;
    }
    button:hover {
      background: #ff85c1;
    }
  </style>
</head>
<body>

  <audio id="gameMusic" src="space.mp3" loop></audio>

  <div id="start-screen">
    <h1>Space Shooter 🚀</h1>
    <p>Shoot asteroids, <br>thinking of them as misunderstandings!</p>
    <button id="btn-start">Start Game</button>
  </div>

  <button onclick="toggleMusic()" style="position: fixed; top: 5px; right: 5px; z-index: 20; font-size: 0.9em;">🎵 Toggle Music</button>


  <div id="rules-screen" style="display:none;">
    <h2>Game Rules</h2>
    <ul style="text-align:left; font-size: 1.1em;">
      <li>Use your mouse to move the spaceship left and right.</li>
      <li>Press <b>Spacebar</b> to shoot bullets upwards.</li>
      <li>Destroy asteroids before they hit you.</li>
      <li>Earn points for every asteroid destroyed.</li>
      <li>Surprise dekhne k liye, you need to score: 10k points.</li>
      <li><b>Bonus:</b> Reach milestones to unlock secret messages 💖</li>
    </ul>
    <button id="btn-play">Let's goooooooo</button>
  </div>

  <div id="game-over" style="display:none; text-align: center;">
    <h1>Game Over</h1>
    <p id="final-score" style="font-size:1.3em; margin-top: 10px;"></p>
    <p>Koi baat nhi, firse khelo. <br>End surprise dekhna h na?</p>
    <button onclick="startGame()">Play Again</button>
    <br />
    <button id="go-to-bubbles" style="margin-top: 10px; background: #ff69b4; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Back to Bubbles</button>
  </div>

  <div id="win-screen" style="display:none;">
    <div class="win-box">
      <h1>Yayyyyyy <br>Jeet gyeeeee tm! 🥳</h1>
      <p style="font-size:1.3em;">Final Score: <span id="final-win-score">10000</span></p>
      <p>Cute h n ye wali photoooooo</p>
      <img src="our_photo.png" alt="Us Together" />
      <br />
      <button onclick="startGame()">Play Again</button>
      <button id="go-to-bubble" style="margin-top: 10px;">Back to Bubbles</button>
    </div>
  </div>



  <div id="scoreboard">Score: 0</div>
  <div id="note-box"></div>

  <canvas id="gameCanvas"></canvas>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    const noteBox = document.getElementById('note-box');
    const scoreboard = document.getElementById('scoreboard');
    const startScreen = document.getElementById('start-screen');
    const rulesScreen = document.getElementById('rules-screen');
    const gameOverScreen = document.getElementById('game-over');

    const btnStart = document.getElementById('btn-start');
    const btnPlay = document.getElementById('btn-play');

    let spaceship, bullets, enemies, score, isGameOver, notesShown;
    let enemySpawnInterval;
    let noteTimeout;

     document.getElementById('go-to-bubbles').addEventListener('click', () => {
      window.location.href = 'bubbles.html';
    });

    // Love notes messages
    const loveNotes = [
      "Ache se khelooooo",
      "I believe in you",
      "Jldi jldi gama khtm kroo",
      "End me surprise haiiii",
      "Focus on the game",
      "Ab disturb nhi krungi",
      "Wo mazak tha",
      "Mai to disturb krungi",
      "Yayyyyy",
      "Bs jitne hi wale ho, hurray"
    ];

    // Set canvas size to fill the window and adjust on resize
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    btnStart.addEventListener('click', () => {
      startScreen.style.display = 'none';
      rulesScreen.style.display = 'block';
    });

    btnPlay.addEventListener('click', () => {
      rulesScreen.style.display = 'none';
      startGame();
    });

    function startGame() {
      document.getElementById('gameMusic').play();
      startScreen.style.display = 'none';
      rulesScreen.style.display = 'none';
      gameOverScreen.style.display = 'none';
      document.getElementById('win-screen').style.display = 'none'; 
      scoreboard.style.display = 'block';
      noteBox.classList.remove('show');
      clearTimeout(noteTimeout);
      clearInterval(enemySpawnInterval);

      spaceship = { x: canvas.width/2 - 20, y: canvas.height - 80, width: 40, height: 40 };
      bullets = [];
      enemies = [];
      score = 0;
      isGameOver = false;
      notesShown = [];

      updateScore();
      spawnEnemies();
      requestAnimationFrame(gameLoop);
    }



  function spawnEnemies() {
    setInterval(() => {
      if (!isGameOver) {
        // Base speed + incremental speed based on score (e.g. every 500 points adds 0.5 speed)
        const baseSpeed = 2;
        const speedIncrement = Math.floor(score / 500) * 0.5; 
        const enemySpeed = baseSpeed + speedIncrement + Math.random();

        enemies.push({
          x: Math.random() * (canvas.width - 40),
          y: -40,
          size: 40,
          speed: enemySpeed
        });
      }
    }, 1000);
  }


    document.addEventListener('keydown', (e) => {
      if (e.code === 'Space' && !isGameOver) {
        bullets.push({ x: spaceship.x + spaceship.width/2 - 2, y: spaceship.y, speed: 7 });
      }
    });

    document.addEventListener('mousemove', (e) => {
      const rect = canvas.getBoundingClientRect();
      let newX = e.clientX - rect.left - spaceship.width/2;
      // Keep spaceship within canvas bounds
      if (newX < 0) newX = 0;
      if (newX + spaceship.width > canvas.width) newX = canvas.width - spaceship.width;
      spaceship.x = newX;
    });

    function gameLoop() {
      if (isGameOver) return;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw spaceship
      ctx.fillStyle = '#00BFFF';
      ctx.beginPath();
      ctx.moveTo(spaceship.x + spaceship.width / 2, spaceship.y); // tip
      ctx.lineTo(spaceship.x, spaceship.y + spaceship.height);     // bottom left
      ctx.lineTo(spaceship.x + spaceship.width, spaceship.y + spaceship.height); // bottom right
      ctx.closePath();
      ctx.fill();


      // Draw bullets
      ctx.fillStyle = '#fff';
      bullets.forEach((b, i) => {
        b.y -= b.speed;
        ctx.fillRect(b.x, b.y, 4, 10);
        if (b.y + 10 < 0) bullets.splice(i, 1);
      });

      // Draw enemies
      ctx.fillStyle = '#ff6347';
      enemies.forEach((en, i) => {
        en.y += en.speed;
        ctx.beginPath();
        ctx.arc(en.x + en.size/2, en.y + en.size/2, en.size/2, 0, Math.PI * 2);
        ctx.fill();


        // Collision with spaceship
        if (en.y + en.size > spaceship.y &&
            en.x < spaceship.x + spaceship.width &&
            en.x + en.size > spaceship.x) {
          endGame();
        }

        // Collision with bullet
        bullets.forEach((b, j) => {
          if (b.x < en.x + en.size &&
              b.x + 4 > en.x &&
              b.y < en.y + en.size &&
              b.y + 10 > en.y) {
            enemies.splice(i, 1);
            bullets.splice(j, 1);
            increaseScore(100);
          }
        });

        // Remove enemies that went off screen
        if (en.y > canvas.height) enemies.splice(i, 1);
      });

      requestAnimationFrame(gameLoop);
    }

    function increaseScore(amount) {
      score += amount;
      updateScore();
      maybeShowNote();

      if (score >= 10000) {
        winGame();
      }
    }


    function updateScore() {
      scoreboard.innerText = `Score: ${score}`;
    }

    function maybeShowNote() {
      if (score >= 500 && !notesShown.includes(0)) {
        showNote(0);
      } else if (score >= 1000 && !notesShown.includes(1)) {
        showNote(1);
      } else if (score >= 2000 && !notesShown.includes(2)) {
        showNote(2);
      } else if (score >= 3000 && !notesShown.includes(3)) {
        showNote(3);
      } else if (score >= 4000 && !notesShown.includes(4)) {
        showNote(4);
      } else if (score >= 5000 && !notesShown.includes(5)) {
        showNote(5);
      } else if (score >= 6000 && !notesShown.includes(6)) {
        showNote(6);
      } else if (score >= 7000 && !notesShown.includes(7)) {
        showNote(7);
      } else if (score >= 8000 && !notesShown.includes(8)) {
        showNote(8);
      } else if (score >= 9000 && !notesShown.includes(9)) {
        showNote(9);
      }
    }

    function showNote(index) {
      notesShown.push(index);
      noteBox.textContent = loveNotes[index];
      noteBox.classList.add('show');

      clearTimeout(noteTimeout);
      noteTimeout = setTimeout(() => {
        noteBox.classList.remove('show');
      }, 3000);
    }

    function endGame() {
      isGameOver = true;
      gameOverScreen.style.display = 'block';
      scoreboard.style.display = 'none'; // hide the top-left scoreboard on game over
      clearInterval(enemySpawnInterval);
      noteBox.classList.remove('show');

      // Show final score in the game over screen
      document.getElementById('final-score').textContent = `Final Score: ${score}`;
    }

    function winGame() {
      isGameOver = true;
      document.getElementById('win-screen').style.display = 'block';
      scoreboard.style.display = 'none';
      clearInterval(enemySpawnInterval);
      noteBox.classList.remove('show');

      document.getElementById('final-win-score').textContent = score;
    }

    document.getElementById('go-to-bubble').addEventListener('click', () => {
      window.location.href = 'bubbles.html'; // Update if your actual page is different
    });

    function toggleMusic() {
      const music = document.getElementById("gameMusic");
      if (music.paused) {
        music.play();
      } else {
        music.pause();
      }
    }



  </script>
      <footer style="
        position: fixed;
        bottom: 10px;
        width: 100%;
        text-align: center;
        font-size: 0.9rem;
        color: #ffffff;
        opacity: 0.7;
    ">
        Developed with ❤️ by Nyasa
    </footer>

</body>
</html>
